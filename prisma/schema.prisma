generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")         // pooled host for runtime
  directUrl = env("DIRECT_DATABASE_URL")  // direct host for db push/seed
}

enum ExerciseType {
  MCQ
  IMAGE_ID
  ORDERING
  CALC
  TERMS
}

enum TrainingSystem {
  PROJECT_MANAGEMENT
  SITE_SUPERVISION
}

model User {
  id            String      @id
  email         String?     @unique
  displayName   String?
  attempts      Attempt[]
  progress      Progress[]
  srsItems      SRSItem[]
  xp            Int         @default(0)
  streak        Int         @default(0)
  lastActiveUTC DateTime?
  userBadges    UserBadge[]
  role          UserRole?
  createdAt     DateTime    @default(now())
}

model Role {
  id      Int   @id @default(autoincrement())
  system  TrainingSystem
  name    String
  level   Int
  users   UserRole[]
  lessons Lesson[]

  @@unique([system, level])
}

model UserRole {
  id     Int    @id @default(autoincrement())
  userId String @unique
  user   User   @relation(fields: [userId], references: [id])
  roleId Int
  role   Role   @relation(fields: [roleId], references: [id])
}

model
