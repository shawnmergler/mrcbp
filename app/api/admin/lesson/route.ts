import { NextResponse } from 'next/server'; import { prisma } from '@/lib/prisma'; import { TrainingSystem } from '@prisma/client'; export async function POST(req: Request){ const b=await req.json(); const {title,description,divisionId,system,roleId}=b||{}; if(!title||!divisionId||!system) return NextResponse.json({error:'Missing fields'},{status:400}); const slug=(title as string).toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); const lesson=await prisma.lesson.create({data:{title,slug,description,divisionId,system:system as TrainingSystem,roleId:roleId||null}}); return NextResponse.json({ok:true,lesson}); }
