import { prisma } from '@/lib/prisma'; export default async function ManageLessonPage({ params }:{ params:{ id:string } }){ const id = Number(params.id); const lesson = await prisma.lesson.findUnique({ where: { id }, include: { exercises: true, division: true, role: true } }); if(!lesson) return <div className='card'>Not found.</div>; return (<div className='space-y-6'><div className='card'><h1 className='text-2xl font-bold'>Lesson: {lesson.title}</h1><p className='text-sm text-gray-600'>Div {String(lesson.division.csiCode).padStart(2,'0')} — {lesson.division.name}</p><p className='text-sm text-gray-600'>System: {lesson.system} {lesson.role ? `| Role: ${lesson.role.level}. ${lesson.role.name}` : ''}</p></div><div className='card'><h2 className='text-lg font-semibold mb-3'>Add Exercise</h2><form action='/api/admin/exercise' method='post' className='grid grid-cols-1 sm:grid-cols-2 gap-3'><input type='hidden' name='lessonId' value={lesson.id} /><div><label className='label'>Type</label><select className='select' name='type' required><option>MCQ</option><option>IMAGE_ID</option><option>ORDERING</option><option>CALC</option></select></div><div className='sm:col-span-2'><label className='label'>Prompt</label><input className='input' name='prompt' required /></div><div className='sm:col-span-2'><label className='label'>Data (JSON)</label><textarea name='data' className='input' rows={5} placeholder='{"choices":["A","B"],"correctIndex":0}'></textarea></div><div className='sm:col-span-2'><label className='label'>Answer (JSON)</label><textarea name='answer' className='input' rows={3} placeholder='{"correctIndex":0}'></textarea></div><div className='sm:col-span-2'><button className='btn btn-primary'>Add</button></div></form></div><div className='card'><h2 className='text-lg font-semibold mb-3'>Exercises</h2><ul className='space-y-2'>{lesson.exercises.map(e=>(<li key={e.id} className='border rounded-xl p-3'><div className='text-sm text-gray-500'>#{e.id} — {e.type}</div><div className='font-medium'>{e.prompt}</div></li>))}</ul></div></div>); }
